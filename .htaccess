# Enable URL rewriting
RewriteEngine On

# Set the base directory to the root
RewriteBase /

# Force HTTPS (only if the site is reachable via HTTPS)
RewriteCond %{HTTPS} off
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Default document
DirectoryIndex index.html

# Serve extensionless URLs when a corresponding .html file exists
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME}.html -f
RewriteRule ^(.*?)/?$ $1.html [L]

# Redirect any direct .html requests to the extensionless URL (SEO friendly)
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /([^.]+)\.html\ HTTP/
RewriteRule ^([^.]+)\.html$ /$1 [R=301,L]

# Caching: leverage browser cache for static assets
<IfModule mod_expires.c>
	ExpiresActive On
	ExpiresByType image/avif "access plus 1 month"
	ExpiresByType image/webp "access plus 1 month"
	ExpiresByType image/jpeg "access plus 1 month"
	ExpiresByType image/png "access plus 1 month"
	ExpiresByType text/css "access plus 1 week"
	ExpiresByType application/javascript "access plus 1 week"
	ExpiresByType text/html "access plus 1 hour"
</IfModule>

# Security headers (helpful when served via Apache)
<IfModule mod_headers.c>
	Header always set X-Frame-Options "SAMEORIGIN"
	Header always set X-Content-Type-Options "nosniff"
	Header always set Referrer-Policy "no-referrer-when-downgrade"
	Header always set X-XSS-Protection "1; mode=block"
	Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
</IfModule>